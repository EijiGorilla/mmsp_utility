"use strict";(self.webpackChunkmmsp_utility=self.webpackChunkmmsp_utility||[]).push([[8103],{8103:(l,e,t)=>{t.d(e,{previewSymbol2D:()=>S});var i=t(1413),o=t(51995),n=t(86950),a=t(10064),s=t(82272),u=t(17842),d=t(79563),h=t(37817),c=t(69157),r=t(81283);const m="picture-fill",v="picture-marker",p="simple-fill",f="simple-line",y="simple-marker",g="text",w="Aa",b=h.b_.size,x=h.b_.maxSize,M=h.b_.maxOutlineSize,k=h.b_.lineWidth,L=225,z=document.createElement("canvas");function Z(l,e){const t=z.getContext("2d"),i=[];e&&(e.weight&&i.push(e.weight),e.size&&i.push(e.size+"px"),e.family&&i.push(e.family)),t.font=i.join(" ");const{width:o,actualBoundingBoxLeft:n,actualBoundingBoxRight:a,actualBoundingBoxAscent:s,actualBoundingBoxDescent:u}=t.measureText(l);return{width:Math.ceil(Math.max(o,n+a)),height:Math.ceil(s+u),x:Math.floor(n),y:Math.floor((s-u)/2)}}function C(l){const e=null===l||void 0===l?void 0:l.size;return{width:null!=e&&"object"==typeof e&&"width"in e?(0,u.F2)(e.width):null,height:null!=e&&"object"==typeof e&&"height"in e?(0,u.F2)(e.height):null}}function F(l,e){return l>e?"dark":"light"}async function S(l,e){var t;const{shapeDescriptor:o,size:n,renderOptions:L}=function(l,e){var t,o,n;const a="number"==typeof(null===e||void 0===e?void 0:e.size)?null===e||void 0===e?void 0:e.size:null,s=null!=a?(0,u.F2)(a):null,c=null!=(null===e||void 0===e?void 0:e.maxSize)?(0,u.F2)(e.maxSize):null;let r="angle"in l?l.angle:null;null!=(null===e||void 0===e?void 0:e.rotation)&&(r=(null!==(t=r)&&void 0!==t?t:0)+e.rotation);const L=(0,d._M)(l);let z=(0,d.mx)(l);"dark"!==B(l,245)||(null===e||void 0===e?void 0:e.ignoreWhiteSymbols)||(z=(0,i.Z)((0,i.Z)({width:.75},z),{},{color:"#bdc3c7"}));const F={shape:null,fill:L,stroke:z,offset:[0,0]};(null===(o=z)||void 0===o?void 0:o.width)&&(z.width=Math.min(z.width,M));const S=(null===(n=z)||void 0===n?void 0:n.width)||0;let _=null!=(null===e||void 0===e?void 0:e.size)&&(null==(null===e||void 0===e?void 0:e.scale)||(null===e||void 0===e?void 0:e.scale)),E=0,j=0,D=!1;switch(l.type){case y:{const t=l.style,{width:i,height:o}=C(e),n=i===o&&null!=i?i:null!=s?s:Math.min((0,u.F2)(l.size),c||x);switch(E=n,j=n,t){case"circle":F.shape={type:"circle",cx:0,cy:0,r:.5*n},_||(E+=S,j+=S);break;case"cross":F.shape={type:"path",path:[{command:"M",values:[0,.5*j]},{command:"L",values:[E,.5*j]},{command:"M",values:[.5*E,0]},{command:"L",values:[.5*E,j]}]};break;case"diamond":F.shape={type:"path",path:[{command:"M",values:[0,.5*j]},{command:"L",values:[.5*E,0]},{command:"L",values:[E,.5*j]},{command:"L",values:[.5*E,j]},{command:"Z",values:[]}]},_||(E+=S,j+=S);break;case"square":F.shape={type:"path",path:[{command:"M",values:[0,0]},{command:"L",values:[E,0]},{command:"L",values:[E,j]},{command:"L",values:[0,j]},{command:"Z",values:[]}]},_||(E+=S,j+=S),r&&(D=!0);break;case"triangle":F.shape={type:"path",path:[{command:"M",values:[.5*E,0]},{command:"L",values:[E,j]},{command:"L",values:[0,j]},{command:"Z",values:[]}]},_||(E+=S,j+=S),r&&(D=!0);break;case"x":F.shape={type:"path",path:[{command:"M",values:[0,0]},{command:"L",values:[E,j]},{command:"M",values:[E,0]},{command:"L",values:[0,j]}]},r&&(D=!0);break;case"path":F.shape={type:"path",path:l.path||""},_||(E+=S,j+=S),r&&(D=!0),_=!0}break}case f:{var O;const{width:l,height:t}=C(e),i=(0,d.iI)(z).reduce(((l,e)=>l+e),0),o=i&&Math.ceil(k/i),n=null!==(O=null!==t&&void 0!==t?t:s)&&void 0!==O?O:S,a=null!==l&&void 0!==l?l:i*o||k;z&&(z.width=n),E=a,j=n,_=!0,F.shape={type:"path",path:[{command:"M",values:[n/2,j/2]},{command:"L",values:[E-n/2,j/2]}]};break}case m:case p:{var A;const l="object"==typeof(null===e||void 0===e?void 0:e.symbolConfig)&&!(null===e||void 0===e||null===(A=e.symbolConfig)||void 0===A||!A.isSquareFill),{width:t,height:i}=C(e);E=!l&&t!==i||null==t?null!=s?s:b:t,j=!l&&t!==i||null==i?E:i,_||(E+=S,j+=S),_=!0,F.shape=l?{type:"path",path:[{command:"M",values:[0,0]},{command:"L",values:[E,0]},{command:"L",values:[E,j]},{command:"L",values:[0,j]},{command:"L",values:[0,0]},{command:"Z",values:[]}]}:h.JZ.fill[0];break}case v:{const t=Math.min((0,u.F2)(l.width),c||x),i=Math.min((0,u.F2)(l.height),c||x),{width:o,height:n}=C(e),a=o===n&&null!=o?o:null!=s?s:Math.max(t,i),d=t/i;E=d<=1?Math.ceil(a*d):a,j=d<=1?a:Math.ceil(a/d),F.shape={type:"image",x:-Math.round(E/2),y:-Math.round(j/2),width:E,height:j,src:l.url||""},r&&(D=!0);break}case g:{const t=l,i=(null===e||void 0===e?void 0:e.overrideText)||t.text||w,o=t.font,{width:n,height:a}=C(e),d=null!=a?a:null!=s?s:Math.min((0,u.F2)(o.size),c||x),{width:h,height:r}=Z(i,{weight:o.weight,size:d,family:o.family}),m=/[\uE600-\uE6FF]/.test(i);E=null!==n&&void 0!==n?n:m?d:h,j=m?d:r;let v=.5*(m?d:r);m&&(v+=5),F.shape={type:"text",text:i,x:t.xoffset||0,y:t.yoffset||v,align:"middle",alignBaseline:t.verticalAlignment,decoration:o&&o.decoration,rotated:t.rotated,kerning:t.kerning},F.font=o&&{size:d,style:o.style,decoration:o.decoration,weight:o.weight,family:o.family};break}}return{shapeDescriptor:F,size:[E,j],renderOptions:{node:null===e||void 0===e?void 0:e.node,scale:_,opacity:null===e||void 0===e?void 0:e.opacity,rotations:[r],useRotationSize:D,effectView:null===e||void 0===e?void 0:e.effectView,ariaLabel:null===e||void 0===e?void 0:e.ariaLabel}}}(l,e);if(!o.shape)throw new a.Z("symbolPreview: renderPreviewHTML2D","symbol not supported.");await async function(l,e){const t=e.fill,i=l.color;if("pattern"===(null===t||void 0===t?void 0:t.type)&&i&&l.type!==m){const l=await(0,d.Od)(t.src,i.toCss(!0));t.src=l,e.fill=t}}(l,o),await async function(l,e,t,i){if(!("font"in l)||!l.font||"text"!==e.shape.type)return;try{await(0,s.mx)(l.font)}catch(c){}const{width:o,height:n}=C(i);if(!/[\uE600-\uE6FF]/.test(e.shape.text)){var a,u,d,h;const{width:s,height:c,x:r,y:m}=Z(e.shape.text,{weight:null===(a=e.font)||void 0===a?void 0:a.weight,size:null===(u=e.font)||void 0===u?void 0:u.size,family:null===(d=e.font)||void 0===d?void 0:d.family});t[0]=null!==o&&void 0!==o?o:s,t[1]=null!==n&&void 0!==n?n:c,e.shape.x=r,e.shape.y=m;let v="angle"in l?l.angle:null;if(null!=(null===i||void 0===i?void 0:i.rotation)&&(v=(null!==(h=v)&&void 0!==h?h:0)+i.rotation),v){const l=v*(Math.PI/180),e=Math.abs(Math.sin(l)),i=Math.abs(Math.cos(l));t[1]=t[0]*e+t[1]*i}}}(l,o,n,e);const z=[[o]];if("object"==typeof(null===e||void 0===e?void 0:e.symbolConfig)&&null!==e&&void 0!==e&&null!==(t=e.symbolConfig)&&void 0!==t&&t.applyColorModulation){const l=.6*n[0];z.unshift([(0,i.Z)((0,i.Z)({},o),{},{offset:[-l,0],fill:(0,h.dc)(o.fill,-.3)})]),z.push([(0,i.Z)((0,i.Z)({},o),{},{offset:[l,0],fill:(0,h.dc)(o.fill,.3)})]),n[0]+=2*l,L.scale=!1}return"text"===l.type&&function(l,e,t,o,n){var a;if(null!=l.haloColor&&null!=l.haloSize){var s;null!==(s=n.masking)&&void 0!==s||(n.masking=t.map((()=>[])));const a=(0,u.F2)(l.haloSize);o[0]+=a,o[1]+=a,t.unshift([(0,i.Z)((0,i.Z)({},e),{},{fill:null,stroke:{color:l.haloColor,width:2*a,join:"round",cap:"round"}})]),n.masking.unshift([{shape:{type:"rect",x:0,y:0,width:o[0]+2*r.c9,height:o[1]+2*r.c9},fill:[255,255,255],stroke:null},(0,i.Z)((0,i.Z)({},e),{},{fill:[0,0,0,0],stroke:null})])}null==l.backgroundColor&&null==l.borderLineColor||(o[0]+=2*r.c9,o[1]+=2*r.c9,t.unshift([{shape:{type:"rect",x:0,y:0,width:o[0],height:o[1]},fill:l.backgroundColor,stroke:{color:l.borderLineColor,width:(0,u.F2)(l.borderLineSize)}}]),null===(a=n.masking)||void 0===a||a.unshift([]))}(l,o,z,n,L),(0,c.wh)(z,n,L)}function B(l){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:L;const t=(0,d._M)(l),i=(0,d.mx)(l),a=!t||"type"in t?null:new o.Z(t),s=null!==i&&void 0!==i&&i.color?new o.Z(null===i||void 0===i?void 0:i.color):null,u=a?F((0,n.EX)(a),e):null,h=s?F((0,n.EX)(s),e):null;return h?u?u===h?u:e>=L?"light":"dark":h:u}}}]);
//# sourceMappingURL=8103.dd6e7fd6.chunk.js.map